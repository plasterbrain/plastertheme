jQuery(function(t){function e(){""==v.val()?(v.addClass("input-error"),C.text(magic_hat.messageEmpty),C.attr("role","alert"),o=v):(v.removeClass("input-error"),C.text(""),C.removeAttr("role")),1==magic_hat.nameRequired&&(""!=y&&k.test(y)?(f.removeClass("input-error"),g.text(""),g.removeAttr("role")):(f.addClass("input-error"),""==y?g.text(magic_hat.emailEmpty):g.text(magic_hat.emailBad),g.attr("role","alert"),o=f),""==d.val()?(d.addClass("input-error"),p.text(magic_hat.authorEmpty),p.attr("role","alert"),o=d):(d.removeClass("input-error"),p.text(""),p.removeAttr("role"))),null!=o&&(d.hasClass("input-error")||f.hasClass("input-error")||v.hasClass("input-error")?(o[0].scrollIntoView({behavior:"smooth",block:"start"}),o.focus()):o=null)}function a(t){s.attr("class","success"),s.attr("role","alert"),s.text(t),s.fadeIn(),s.delay(3e3).fadeOut(),wp.a11y.speak(magic_hat.updateMsg,"polite")}var r,o=null,n=t("#comments-title"),l="#comments-list-nav",s=t("#comments-status"),i=t("#comments-page-title"),c=t("#comments-list"),m=t("#comments-filler"),u=t("#respond"),h=t("#cancel-comment-reply-link"),d=t("#author"),p=t("#author-error"),f=t("#email"),g=t("#email-error"),v=t("#comment"),C=t("#comment-error"),_=t("#commentform"),x=t("#submit"),b=t("#submit-error"),k=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,})?$/,y=f.val(),w=!!t.fn.on,I=1,E=1,O=0,P=u.prev("li").find(".children").first();t.extend(t.fn,{loadComments:function(e){t(l).fadeOut(500,function(){m.css("height",t(l).css("height")),t(this).load(e+" "+l+" > *",function(){m.css("height",0),t(this).fadeIn(500),n[0].scrollIntoView({behavior:"smooth",block:"start"})})})},loadCommentsPage:function(e){e.preventDefault(),t(this).loadComments(t(this).attr("href")),i.focus()}}),1==magic_hat.pageComments&&(I=t("#comments-nav").children(".current").first().text(),I=null!==I?parseInt(I):1,E=c.data("total"),E=null!==E?parseInt(E):1,O=c.data("overflow"),O=null!==O?parseInt(O):1),w?t(document).on("click","#comments-nav a",function(e){t(this).loadCommentsPage(e)}).on("click","#delete-link a",function(e){t(this).deleteComment(e)}):(t("#comments-nav").live("click","a",function(e){t(this).loadCommentsPage(e)}),t("#delete-link").live("click","a",function(e){t(this).deleteComment(e)})),_.submit(function(){return e(),x.hasClass("button-loading")||null!=o||t.ajax({type:"POST",url:magic_hat.ajaxurl,data:t(this).serialize()+"&action=magic_hat_comment_handler",beforeSend:function(t){x.addClass("button-loading")},error:function(t,e,a){"timeout"==e&&b.text(magic_hat.timeout),b.attr("role","alert")},statusCode:{409:function(){b.text(magic_hat.duplicateError)},429:function(){b.text(magic_hat.floodError)},500:function(){b.text(magic_hat.serverError)}},success:function(e){a(magic_hat.postSuccess),0<c.length?u.parent().hasClass("comment-list")?(e='<ol class="children">'+e+"</ol>",u.prev().append(e),h.trigger("click")):u.parent().hasClass("children")?(0===P.length?(e='<ol class="children">'+e+"</ol>",u.prev().append(e)):P.append(e),h.trigger("click")):!magic_hat.pageComments||0!=O&&I===E?"desc"==magic_hat.commentOrder?c.prepend(t(e)):c.append(t(e)):(r=0==O?magic_hat.baseurl.replace("%#%",E+1):magic_hat.baseurl.replace("%#%",E),t(this).loadComments(r)):(e='<ol id="comments-list" class="comment-list">'+e+"</ol>",u.before(t(e))),t("#comment").val("")},complete:function(){x.removeClass("button-loading")}}),!1})});